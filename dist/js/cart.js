"use strict";!function(){var t="http://10.31.157.28/js1907/project/php/";$.ajax({type:"post",url:t+"goodsdata.php",dataType:"json"}).done(function(o){var t="";$.each(o,function(o,i){o<20&&(t+='\n                    <li>\n                    <a href="javascript" class="proPic">\n                        <img src="'+i.url+'" alt=""></a>\n                     <p class="productPrice">  ￥'+i.price+' </p> \n                     <p class="productTitle"> <a href="">'+i.title2+'</a> </p>\n                     <p class="comments"> 评论数：<a href="">351条</a> </p>\n                    </li>\n                    ',$(".productList").html(t))})});var e=[],n=[];function s(){var t=0,e=0;$(".goods_row:visible").each(function(o,i){$(i).find(".cart-checkbox input").prop("checked")&&(t+=parseInt($(i).find(".ipt-num").val()),e+=parseFloat($(i).find(".subTotal").html()))}),$("#CheckedCount").html(t),$("#PreOrderAmount").html(e)}function i(o){var i=o.parents(".goods_row").find("img").attr("sid");n[$.inArray(i,e)]=o.parents(".goods_row").find(".ipt-num").val(),addcookie("cookienum",n,10)}function c(o){return(parseInt(o.parents(".goods_row").find(".ipt-num").val())*parseFloat(o.parents(".goods_row").find(".salePrice").html())).toFixed(2)}function r(t,o){var e=-1;$.each(o,function(o,i){t===i&&(e=o)}),o.splice(e,1),n.splice(e,1),addcookie("cookiesid",o,10),addcookie("cookienum",n,10)}getcookie("cookiesid")&&getcookie("cookienum")&&(getcookie("cookiesid")&&getcookie("cookienum")&&(e=getcookie("cookiesid").split(","),n=getcookie("cookienum").split(",")),$.each(e,function(o,i){!function(e,n){$.ajax({type:"post",url:t+"goodsdata.php",dataType:"json"}).done(function(o){$.each(o,function(o,i){if(e==i.sid){var t=$(".goods_row:hidden").clone(!0,!0);t.find(".orderproPic").find("img").attr("src",i.urls.split(",")[0]),t.find(".orderproPic").find("img").attr("sid",i.sid),t.find(".orderproTt").children("a").html(i.title2),t.find(".ipt-num").val(n),t.find(".salePrice").html(i.price),t.find(".subTotal").html((i.price*n).toFixed(2)),t.css("display","block"),$(".cart-body").prepend(t),s()}})})}(e[o],n[o])})),getcookie("cookiesid")&&getcookie("cookienum")?($(".cart-empty ").hide(),$(".recom-list-title").hide(),$(".buyTop").hide(),$(".shoppingCartGrid").show(),$(".cart-panel").show()):($(".cart-empty ").show(),$(".recom-list-title").show(),$(".buyTop").show(),$(".shoppingCartGrid").hide(),$(".cart-panel").hide()),$(".allsel").on("change",function(){$(".goods_row:visible").find(":checkbox").prop("checked",$(this).prop("checked")),$(".allsel").prop("checked",$(this).prop("checked")),s()}),$(".cart-body").on("change",$(".goods_row:visible").find(":checkbox"),function(){$(".goods_row:visible").find(":checkbox").length===$(".goods_row:visible").find("input:checked").length?$(".allsel").prop("checked",!0):$(".allsel").prop("checked",!1),s()}),$(".inc").on("click",function(){var o=$(this).parents(".goods_row").find(".ipt-num").val();99<++o&&(o=99),$(this).parents(".goods_row").find(".ipt-num").val(o),$(this).parents(".goods_row").find(".subTotal").html(c($(this))),s(),i($(this))}),$(".dec").on("click",function(){var o=$(this).parents(".goods_row").find(".ipt-num").val();--o<=1&&(o=1),$(this).parents(".goods_row").find(".ipt-num").val(o),$(this).parents(".goods_row").find(".subTotal").html(c($(this))),s(),i($(this))}),$(".ipt-num").on("input",function(){var o=parseInt($(this).val());/^\d+$/g.test(o)?99<o?$(this).val(99):o<=0?$(this).val(1):$(this).val(o):$(this).val(1),$(this).parents(".goods_row").find(".subTotal").html(c($(this))),s(),i($(this))}),$(".Delete").on("click",function(){confirm("您确定删除吗？")&&$(this).first().parents(".goods_row").remove(),r($(this).first().parents(".goods_row").find("img").attr("sid"),e),s()}),$(".del").on("click",function(){confirm("您确定删除选中的商品吗？")&&$(".goods_row:visible").each(function(o,i){$(i).find("input:checkbox").is(":checked")&&($(i).remove(),r($(i).find("img").attr("sid"),e))}),s(),window.location.reload()})}();